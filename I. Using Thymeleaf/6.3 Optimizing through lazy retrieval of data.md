### 6.3 通过数据的懒惰检索实现优化

有时我们可能想要优化对数据的集合（比如来自于数据库）的检索。如果这些集合确实要被使用，才会被检索。
```
实际上，这可以被应用到任何一块数据。这种场景的最普遍案例是给出集合在内存中的大小，遍历检索数据。
```
In order to support this, Thymeleaf offers a mechanism to lazily load context variables. Context variables that implement the `ILazyContextVariable` interface – most probably by extending its `LazyContextVariable` default implementation – will be resolved in the moment of being executed. For example:
```java
context.setVariable(
     "users",
     new LazyContextVariable<List<User>>() {
         @Override
         protected List<User> loadValue() {
             return databaseRepository.findAllUsers();
         }
     });
```
This variable can be used without knowledge of its lazyness, in code such as:
```html
<ul>
  <li th:each="u : ${users}" th:text="${u.name}">user name</li>
</ul>
```
But at the same time, will never be initialized (its `loadValue()` method will never be called) if `condition` evaluates to `false` in code such as:
```html
<ul th:if="${condition}">
  <li th:each="u : ${users}" th:text="${u.name}">user name</li>
</ul>
```
