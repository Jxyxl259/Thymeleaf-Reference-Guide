### 13.1 文本语法

有三种Thymeleaf模版模式被认为是`文本`：`文本`，`JAVASCRIPT`和`CSS`。它们区别于标记模版模式：`HTML`和`XML`.

文本模版模式与标记模版模式的关键区别在于：在文本模版里，没有标签可供我们以属性的形式插入逻辑。所以，我们不得不依赖其它的机制。

这些机制里第一位同时也是最基础的就是`内联`。我们在之前的章节里详细介绍过。在文本模版模式里，内联语法是输出表达式结果的最简单的方式。 所以，这是用于一封文本邮件的完全有效的模版。
```
  Dear [(${name})],

  Please find attached the results of the report you requested
  with name "[(${report.name})]".

  Sincerely,
    The Reporter.
```
即使没有标签，上面的例子也是一个完整有效的Thymeleaf模板。它可以在`文本`模板模式下执行。

但是，为了包含更复杂的逻辑，而不仅仅只是输出表达式，我们需要一种新的基于无标签的语法：
```
[# th:each="item : ${items}"]
  - [(${item})]
[/]
```
这实际上是如下复杂版本的压缩：
```
[#th:block th:each="item : ${items}"]
  - [#th:block th:utext="${item}" /]
[/th:block]
```
注意：这种新语法基于元素（也就是可处理的标签）。它们被声明为`[#element ...]`，而不是`<element ...>`。元素像`[#element ...]`这样开始，像`[/element]`这样结束。独立标签可以用开始元素附上`/`声明，几乎等价于XML标签：`[#element ... /]`。

标准方言只包含一个处理器，对应于这些元素中的其中一个：已经知道的`th:block`。尽管我们可以在方言里扩展它，已通常的方式创建新元素。而且，`th:block`元素（`[#th:block ...] ... [/th:block]`）可以简写为空字符串（`[# ...] ... [/]`），所以上面的代码块实际上等价于：
```
[# th:each="item : ${items}"]
  - [# th:utext="${item}" /]
[/]
```
And given `[# th:utext="${item}" /]` is equivalent to an inlined unescaped expression, we could just use it in order to have less code. Thus we end up with the first fragment of code we saw above:
```
[# th:each="item : ${items}"]
  - [(${item})]
[/]
```
Note that the textual syntax requires full element balance (no unclosed tags) and quoted attributes – it’s more XML-style than HTML-style.

Let’s have a look at a more complete example of a TEXT template, a plain text email template:
```
Dear [(${customer.name})],

This is the list of our products:

[# th:each="prod : ${products}"]
   - [(${prod.name})]. Price: [(${prod.price})] EUR/kg
[/]

Thanks,
  The Thymeleaf Shop
```
After executing, the result of this could be something like:
```
Dear Mary Ann Blueberry,

This is the list of our products:

   - Apricots. Price: 1.12 EUR/kg
   - Bananas. Price: 1.78 EUR/kg
   - Apples. Price: 0.85 EUR/kg
   - Watermelon. Price: 1.91 EUR/kg

Thanks,
  The Thymeleaf Shop
```
And another example in `JAVASCRIPT` template mode, a `greeter.js` file, we process as a textual template and which result we call from our HTML pages. Note this is not a `<script>` block in an HTML template, but a `.js` file being processed as a template on its own:
```javascript
var greeter = function() {

    var username = [[${session.user.name}]];

    [# th:each="salut : ${salutations}"]    
      alert([[${salut}]] + " " + username);
    [/]

};
```
After executing, the result of this could be something like:
```javascript
var greeter = function() {

    var username = "Bertrand \"Crunchy\" Pear";

      alert("Hello" + " " + username);
      alert("Ol\u00E1" + " " + username);
      alert("Hola" + " " + username);

};
```
